SLURM_JOBID=10611858
SLURM_JOB_NODELIST=iris-hgx-2
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /iris/u/jrpan/slurm_jobs
Testing GPU availability:
Wed Jul 16 16:23:01 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H200                    On  |   00000000:2A:00.0 Off |                    0 |
| N/A   45C    P0             87W /  700W |       1MiB / 143771MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H200                    On  |   00000000:3B:00.0 Off |                    0 |
| N/A   54C    P0             84W /  700W |       1MiB / 143771MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H200                    On  |   00000000:5D:00.0 Off |                    0 |
| N/A   39C    P0             78W /  700W |       1MiB / 143771MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H200                    On  |   00000000:9B:00.0 Off |                    0 |
| N/A   41C    P0             79W /  700W |       1MiB / 143771MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
------TRAIN CONFIG------ TrainConfig(name='pi0_fast_robomemory_low_mem_finetune', project_name='openpi', exp_name='lora_10k_0716', model=Pi0FASTConfig(action_dim=8, action_horizon=10, max_token_len=180, dtype='bfloat16', paligemma_variant='gemma_2b_lora'), weight_loader=CheckpointWeightLoader(params_path='gs://openpi-assets/checkpoints/pi0_fast_droid/params'), lr_schedule=CosineDecaySchedule(warmup_steps=1000, peak_lr=2.5e-05, decay_steps=30000, decay_lr=2.5e-06), optimizer=AdamW(b1=0.9, b2=0.95, eps=1e-08, weight_decay=1e-10, clip_gradient_norm=1.0), ema_decay=None, freeze_filter=All(PathRegex(pattern=re.compile('.*llm.*'), sep='/'), Not(PathRegex(pattern=re.compile('.*lora.*'), sep='/'))), data=LeRobotRoboMemoryDataConfig(repo_id='jennypan00/pi0_fast_ft_droid_lerobot_train', assets=AssetsConfig(assets_dir='/iris/u/jrpan/openpi/assets', asset_id='pi0_fast_robomemory_low_mem_finetune/jennypan00/pi0_fast_ft_droid_lerobot'), base_config=DataConfig(repo_id=None, asset_id=None, norm_stats=None, repack_transforms=Group(inputs=(), outputs=()), data_transforms=Group(inputs=(), outputs=()), model_transforms=Group(inputs=(), outputs=()), use_quantile_norm=False, action_sequence_keys=('actions',), prompt_from_task=True, rlds_data_dir=None, action_space=None)), assets_base_dir='./assets', checkpoint_base_dir='./checkpoints', seed=42, batch_size=128, num_workers=2, num_train_steps=10000, log_interval=100, save_interval=1000, keep_period=1000, overwrite=False, resume=True, wandb_enabled=True, policy_metadata=None, fsdp_devices=1)
------device_count------ 4
------per_device_batch_size------ 32
------create_data_loader CONFIG------ DataConfig(repo_id='jennypan00/pi0_fast_ft_droid_lerobot_train', asset_id='pi0_fast_robomemory_low_mem_finetune/jennypan00/pi0_fast_ft_droid_lerobot', norm_stats={'state': NormStats(mean=array([-0.00710411,  0.15619904, -0.01767451, -1.99657547, -0.07513031,
        2.1193223 ,  0.01568275,  0.21138149]), std=array([0.13405874, 0.27428612, 0.10938282, 0.39106756, 0.10412953,
       0.23505557, 0.15655467, 0.29180354]), q01=array([-0.28759005, -0.596502  , -0.20438829, -2.51333459, -0.2860797 ,
        1.64148902, -0.31715395,  0.        ]), q99=array([ 0.23239853,  0.66258552,  0.16586766, -1.16689828,  0.30988115,
        2.59388804,  0.37529621,  0.8412476 ])), 'actions': NormStats(mean=array([-2.57924316e-04, -4.89077605e-02,  1.31247193e-03, -1.21890428e-02,
       -8.38652998e-03, -3.93134840e-02,  3.11966147e-02,  2.81259686e-01]), std=array([0.09779318, 0.35624772, 0.06514142, 0.41298556, 0.11506774,
       0.23008628, 0.16161403, 0.38538089]), q01=array([-0.22644189, -0.79769669, -0.13650613, -0.98502014, -0.2444587 ,
       -0.43700014, -0.33647185,  0.        ]), q99=array([0.17547077, 0.60759123, 0.13985287, 0.76998863, 0.25618212,
       0.45138149, 0.34837817, 0.9998    ]))}, repack_transforms=Group(inputs=(), outputs=()), data_transforms=Group(inputs=[RoboMemoryInputs(action_dim=8, model_type=<ModelType.PI0_FAST: 'pi0_fast'>)], outputs=[RoboMemoryOutputs()]), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizeFASTInputs(tokenizer=<openpi.models.tokenizer.FASTTokenizer object at 0x1546562667d0>)], outputs=[ExtractFASTActions(tokenizer=<openpi.models.tokenizer.FASTTokenizer object at 0x15465629fdd0>, action_horizon=10, action_dim=8)]), use_quantile_norm=True, action_sequence_keys=('actions',), prompt_from_task=True, rlds_data_dir=None, action_space=None)
------CREATING TRAIN DATASET------ jennypan00/pi0_fast_ft_droid_lerobot_train
------DATASET META------ LeRobotDatasetMetadata({
    Repository ID: 'jennypan00/pi0_fast_ft_droid_lerobot_train',
    Total episodes: '242',
    Total frames: '20694',
    Features: '['exterior_image_1_left', 'wrist_image_left', 'joint_position', 'gripper_position', 'prompt', 'actions', 'timestamp', 'frame_index', 'episode_index', 'index', 'task_index']',
})',

------NUM BATCHES------ None
------create_data_loader CONFIG------ DataConfig(repo_id='jennypan00/pi0_fast_ft_droid_lerobot_train', asset_id='pi0_fast_robomemory_low_mem_finetune/jennypan00/pi0_fast_ft_droid_lerobot', norm_stats={'state': NormStats(mean=array([-0.00710411,  0.15619904, -0.01767451, -1.99657547, -0.07513031,
        2.1193223 ,  0.01568275,  0.21138149]), std=array([0.13405874, 0.27428612, 0.10938282, 0.39106756, 0.10412953,
       0.23505557, 0.15655467, 0.29180354]), q01=array([-0.28759005, -0.596502  , -0.20438829, -2.51333459, -0.2860797 ,
        1.64148902, -0.31715395,  0.        ]), q99=array([ 0.23239853,  0.66258552,  0.16586766, -1.16689828,  0.30988115,
        2.59388804,  0.37529621,  0.8412476 ])), 'actions': NormStats(mean=array([-2.57924316e-04, -4.89077605e-02,  1.31247193e-03, -1.21890428e-02,
       -8.38652998e-03, -3.93134840e-02,  3.11966147e-02,  2.81259686e-01]), std=array([0.09779318, 0.35624772, 0.06514142, 0.41298556, 0.11506774,
       0.23008628, 0.16161403, 0.38538089]), q01=array([-0.22644189, -0.79769669, -0.13650613, -0.98502014, -0.2444587 ,
       -0.43700014, -0.33647185,  0.        ]), q99=array([0.17547077, 0.60759123, 0.13985287, 0.76998863, 0.25618212,
       0.45138149, 0.34837817, 0.9998    ]))}, repack_transforms=Group(inputs=(), outputs=()), data_transforms=Group(inputs=[RoboMemoryInputs(action_dim=8, model_type=<ModelType.PI0_FAST: 'pi0_fast'>)], outputs=[RoboMemoryOutputs()]), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizeFASTInputs(tokenizer=<openpi.models.tokenizer.FASTTokenizer object at 0x1525a3db5ad0>)], outputs=[ExtractFASTActions(tokenizer=<openpi.models.tokenizer.FASTTokenizer object at 0x1546561300d0>, action_horizon=10, action_dim=8)]), use_quantile_norm=True, action_sequence_keys=('actions',), prompt_from_task=True, rlds_data_dir=None, action_space=None)
------CREATING EVAL DATASET------ jennypan00/pi0_fast_ft_droid_lerobot_test
------DATASET META------ LeRobotDatasetMetadata({
    Repository ID: 'jennypan00/pi0_fast_ft_droid_lerobot_test',
    Total episodes: '50',
    Total frames: '3795',
    Features: '['exterior_image_1_left', 'wrist_image_left', 'joint_position', 'gripper_position', 'prompt', 'actions', 'timestamp', 'frame_index', 'episode_index', 'index', 'task_index']',
})',

------NUM BATCHES------ None
